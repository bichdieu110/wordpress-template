<?php
/*
* Template Name: News page
*/
get_header();

?>

<div class="l-topBody">
    <div class="p-pageVisual">
      <div class="p-pageVisual_content">
        <div class="p-pageVisual_content_text">
          <h2 class="p-pageVisual_content_text_title">News</h2>
          <p>
            お知らせ
          </p>
        </div>
        <div class="p-mainVisual_content_cover">
          <div class="p-mainVisual_content_cover_base1"></div>
          <div class="p-mainVisual_content_cover_base2"></div>
          <div class="p-mainVisual_content_cover_base3"></div>
          <div class="p-mainVisual_content_cover_particles" id="ji_particles"></div>
          <div class="p-mainVisual_content_cover_obj1">
            <div class="p-mainVisual_content_cover_obj1_s1"></div>
          </div>
          <div class="p-mainVisual_content_cover_obj2">
            <div class="p-mainVisual_content_cover_obj2_s2"></div>
          </div>
          <div class="p-mainVisual_content_cover_obj3">
            <div class="p-mainVisual_content_cover_obj3_s3"></div>
          </div>
          <div class="p-mainVisual_content_cover_obj4">
            <div class="p-mainVisual_content_cover_obj4_s4"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="l-pageBody">

<main class="l-pageMain">

  <!-- Page News -->
  <div class="l-pageNews l-topSection">
    <div class="l-topContent">
      <section class="p-pageNews">
        <div class="p-pageNews_content">
          <form action="">
            <div class="p-pageNews_content_sort c-formBlock">
              <div class="p-pageNews_content_sort_gr c-formBlock_sorts">
                <select class="c-formBlock_sorts_control jc_customSelect" placeholder="年別">
                  <option>2020</option>
                  <option>2019</option>
                  <option>2018</option>
                  <option>2017</option>
                </select>
              </div>
              <div class="p-pageNews_content_sort_gr c-formBlock_sorts">
                <select class="c-formBlock_sorts_control jc_customSelect" placeholder="カテゴリー">
                  <option>活動ニュース</option>
                  <option>大きなイベント</option>
                </select>
              </div>
            </div>
          </form>
          <ul class="p-pageNews_content_list">
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>企業情報</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>企業情報</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>製品サービス情報</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>セミナー・イベント情報</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>ARサービス</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>企業情報</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>企業情報</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>製品サービス情報</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>セミナー・イベント情報</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
            <li class="p-pageNews_content_list_item"><b>2020 04.30</b><span>ARサービス</span><a href="#">コンテンツの統合ディレクションをご提供しています。コンテンツの統合ディレクションをご提供しています。</a></li>
          </ul>
          <a class="p-pageNews_content_readMore c-button" href="./company">Read More</a>
        </div>
      </section>
    </div>
  </div>
  <!-- /page News -->
</main>

<!-- Social -->
<div class="l-pageContent">
  <seciton class="p-mainSocial">
    <ul class="p-mainSocial_list">
      <li class="p-mainSocial_list_sns"><a href="#"><img src="<?php echo URL_IMAGE?>/icon_fb.png" alt="facebook"></a></li>
      <li class="p-mainSocial_list_sns"><a href="#"><img src="<?php echo URL_IMAGE?>/icon_tw.png" alt="twitter"></a></li>
      <li class="p-mainSocial_list_sns"><a href="#"><img src="<?php echo URL_IMAGE?>/icon_line.png" alt="line"></a></li>
    </ul>
  </seciton>
</div>
<!-- /Social -->

<!-- Contact -->
<div class="l-mainContact">
  <div class="l-pageContent">
    <section class="p-mainContact">
      <div class="p-mainContact_title">
        <h2 class="c-titleSection">Contact Us<span>お問い合わせ</span></h2>
        <p class="p-mainContact_title_para">サービスや事業に関すること、ご依頼までどんなことでもご相談ください</p>
        <div class="p-mainContact_title_linkContact">
          <a href="#" class="c-linkContact"><span>お問い合わせフォーム</span></a>
        </div>
      </div>
    </section>
  </div>
</div>
</div>
<?php get_footer(); ?>

<script type="text/javascript">
    (function($){
        ({
            init: function(){
                this.define();
                $(function(){
                    // $this.loadData();
                    $this.search();
                    $this.pagination();
                    // $this.resetSearch();
                });
            },
            define: function() {
                $this = this;
            },
            loadData: function() {
                $this.getData(1, null, null, null, false);
            },
            search: function() {
                this.define();
                var $archive = '',
                    $term = [],
                    $tag = [];

                // Seach has value
                $('form.filter-news').each(function() {
                  var _form = $(this);
                    $(this).find("select").change(function(e) {

                        if(_form.find('select#archive_dropdown option').is(':selected') ){
                          $archive = _form.find('select#archive_dropdown option:selected').val();
                        };

                        if(_form.find('select#term_dropdown option').is(':selected') ){
                          $term = _form.find('select#term_dropdown option:selected').val();
                        };

                      if(($archive != '') || ($term != '')) {
                        $this.getData(1, $archive, $term, $tag, true);
                      } else {
                        $this.getData(1, $archive, $term, $tag, false);
                      }
                      $archive = '';
                      $term = [];
                      $tag = [];
                    });
                });
            },
            resetSearch: function() {
              this.define();
              $('.search-result').on('click', '.top-link', function(){
                $this.getData(1, null, null, null, false);
                $('#archive_dropdown').prop('selectedIndex',0);
                $('#term_dropdown').prop('selectedIndex',0);
                $archive = '';
                $term = [];
                $tag = [];
              });
            },
            pagination: function() {
                this.define();
                var $archive = '', $term = [], $tag = [];
                $('.search-result').on('click', '.paging a', function(){
                    var page = $(this).attr('data-page');

                    $('form.filter-news').each(function() {

                        if($(this).find('select#archive_dropdown option').is(':selected') ){
                          $archive = $(this).find('select#archive_dropdown option:selected').val();
                        };

                        if($(this).find('select#term_dropdown option').is(':selected') ){
                          $term = $(this).find('select#term_dropdown option:selected').val();
                        };
                    });

                    $this.getData(page, $archive, $term, $tag, true);
                    $archive = '';
                    $term = [];
                    $tag = [];
                });
            },
            getData: function($page, $archive = null, $term = null, $tag = null,  $back) {
                this.define();
                jQuery.ajax({
                    url: ajax_object.ajaxurl,
                    type: 'post',
                    data: {
                        action: 'ajax_get_property',
                        page: $page,
                        value: {
                          archive_dropdown: $archive,// $my_input['archive_dropdown']
                          term_dropdown: $term, // $my_input['term_dropdown']
                          term_tag: $tag // $my_input['term_tag']
                        }
                    },
                    dataType: 'html',
                    beforeSend: function() {
                        $('.search-result').empty();
                        $this.showLoading();
                        // $('html, body').animate({
                        //     scrollTop: $(".search-result").offset().top
                        // }, 1000);
                    },
                    success: function( html ) {
                        if($back) { html += '<p class="txt-center"><a href="/news" class="top-link">News Top</a></p>';}
                        $this.hideLoading();
                        $('.search-result').append( html );

                        $('#filterSchool').find('select').each(function() {
                            if( $(this).is(":disabled") ){
                                $(this).removeAttr('disabled');
                            }
                        });
                    },
                    error: function(XMLHttpRequest, textStatus, errorThrown) {
                        console.log(errorThrown);
                    }
                });
            },
            showLoading: function() {
                $('.search-result').append( '<div class="content-loading"><span id="loader"></span></div>' );
            },
            hideLoading: function() {
                $('.content-loading').remove();
            }

        }.init());

    }(jQuery));
</script>